(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{14:function(e,t,a){},15:function(e,t,a){},16:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),r=a(4),c=a.n(r),o=(a(14),a(1));a(15);var i=function(e){let{title:t,onClick:a}=e;return l.a.createElement("div",{className:"header"},l.a.createElement("span",{className:"app-title clickable",onClick:a},t))};var s=function(e){let{clients:t,selectedClientId:a,onSelectClient:n}=e;return l.a.createElement("div",{className:"client-list"},t.map((e,t)=>l.a.createElement("div",{key:e.id,className:"client-row"+(null===a&&0===t||a===e.id?" selected":""),onClick:()=>n(e.id)},e.firstName," ",e.lastName)))};var m=function(e){let{editMode:t,loading:a,onEditClient:n,onSaveClient:r,onDeleteClient:c}=e;return l.a.createElement("div",{className:"client-actions"},l.a.createElement("button",{disabled:a,onClick:t?r:n},t?"Ulo\u017eit zm\u011bny":"Upravit klienta"),l.a.createElement("button",{disabled:a,onClick:c},"Smazat klienta"))};var d=function(e){let{clientForm:t,loading:a,onChange:n,onSave:r}=e;return l.a.createElement("div",{className:"client-form"},l.a.createElement("input",{placeholder:"Jm\xe9no",value:t.firstName,onChange:e=>n(Object(o.a)(Object(o.a)({},t),{},{firstName:e.target.value}))}),l.a.createElement("input",{placeholder:"P\u0159\xedjmen\xed",value:t.lastName,onChange:e=>n(Object(o.a)(Object(o.a)({},t),{},{lastName:e.target.value}))}),l.a.createElement("button",{onClick:r,disabled:a},"Ulo\u017eit klienta"))};var u=function(e){let{type:t,loading:a,onDelete:n,onClose:r}=e;return"client-delete-confirm"===t?l.a.createElement("div",{className:"modal"},l.a.createElement("div",{className:"modal-content"},l.a.createElement("p",null,"Smazat tohoto klienta?"),l.a.createElement("button",{onClick:n,disabled:a},"Smazat"),l.a.createElement("button",{onClick:r},"Zp\u011bt"))):"client-delete-error"===t?l.a.createElement("div",{className:"modal"},l.a.createElement("div",{className:"modal-content"},l.a.createElement("p",null,"Nelze smazat klienta, dokud m\xe1 aktivn\xed rezervace."),l.a.createElement("button",{onClick:r},"Zp\u011bt"))):null};const N=["Po","\xdat","St","\u010ct","P\xe1","So","Ne"];function f(e){const t=new Date(e),a=t.getDay(),n=t.getDate()-a+(0===a?-6:1);return new Date(t.setDate(n))}function v(e){return!e||isNaN(new Date(e).getTime())?"":new Date(e).toISOString().split("T")[0]}var h=function(){const[e,t]=Object(n.useState)("dashboard"),[a,r]=Object(n.useState)(f(new Date)),[c,h]=Object(n.useState)(!1),[E,p]=Object(n.useState)([]),[b,C]=Object(n.useState)([]),[g,k]=Object(n.useState)(null),[y,j]=Object(n.useState)({firstName:"",lastName:""}),[w,S]=Object(n.useState)(!1),[O,D]=Object(n.useState)(null),[T,z]=Object(n.useState)(!1);function I(e,t){const n=new Date(a);n.setDate(n.getDate()+e);const l=v(n);return E.find(e=>e.date&&e.date.slice(0,10)===l&&e.hour===t)}function P(e,t,n,l){if(!e.trim()||!t.trim())return void alert("Vypl\u0148te jm\xe9no i p\u0159\xedjmen\xed.");z(!0);let r=b.find(a=>a.firstName===e&&a.lastName===t);const c=new Date(a);c.setDate(c.getDate()+n);const o=v(c);var i;r?(i=r.id,z(!0),fetch("/reservations",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clientId:i,date:o,hour:l})}).then(e=>e.ok?e.json():e.json().then(e=>{throw new Error(e.error||"Chyba p\u0159i vytv\xe1\u0159en\xed rezervace")})).then(()=>{D(null),fetch("/reservations?week=".concat(v(a))).then(e=>e.json()).then(e=>p(e))}).catch(e=>{console.error(e),alert(e.message||"Nepoda\u0159ilo se vytvo\u0159it rezervaci.")}).finally(()=>z(!1))):fetch("/clients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({firstName:e,lastName:t})}).then(async e=>{if(!e.ok){const t=await e.json();if(t&&t.error&&t.error.includes("existuje"))return void alert("Klient u\u017e existuje.");throw new Error("Chyba p\u0159i vytv\xe1\u0159en\xed klienta")}return e.json()}).then(e=>{e&&(j({firstName:"",lastName:""}),C(t=>[...t,e]))}).finally(()=>z(!1))}function K(){z(!0),w?fetch("/clients/".concat(g),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({firstName:y.firstName,lastName:y.lastName})}).then(async e=>{if(!e.ok){const t=await e.json();if(t&&t.error&&t.error.includes("existuje"))return alert("Klient u\u017e existuje."),void z(!1);throw new Error("Chyba p\u0159i \xfaprav\u011b klienta")}return e.json()}).then(e=>{e&&(S(!1),j({firstName:"",lastName:""}),fetch("/clients").then(e=>e.json()).then(e=>C(e)))}).finally(()=>z(!1)):fetch("/clients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({firstName:y.firstName,lastName:y.lastName})}).then(async e=>{if(!e.ok){const t=await e.json();if(t&&t.error&&t.error.includes("existuje"))return void alert("Klient u\u017e existuje.");throw new Error("Chyba p\u0159i vytv\xe1\u0159en\xed klienta")}return e.json()}).then(e=>{e&&(j({firstName:"",lastName:""}),C(t=>[...t,e]))}).finally(()=>z(!1))}return Object(n.useEffect)(()=>{fetch("/reservations?week=".concat(v(a))).then(e=>e.json()).then(e=>p(e))},[a]),Object(n.useEffect)(()=>{fetch("/clients").then(e=>e.json()).then(e=>{const t=e.sort((e,t)=>{const a=e.firstName.toLowerCase(),n=t.firstName.toLowerCase();return a===n?e.lastName.toLowerCase().localeCompare(t.lastName.toLowerCase()):a.localeCompare(n)});C(t)})},[]),Object(n.useEffect)(()=>{b.length>0&&null===g&&k(b[0].id)},[b,g]),Object(n.useEffect)(()=>{"clients"===window.localStorage.getItem("bookeeapp_screen")&&t("clients")},[]),Object(n.useEffect)(()=>{window.localStorage.setItem("bookeeapp_screen",e)},[e]),"clients"===e?l.a.createElement("div",{className:"mobile-container"},l.a.createElement(i,{title:"BookeeApp",onClick:()=>t("dashboard")}),l.a.createElement("div",{className:"header-sub"},l.a.createElement("span",{className:"page-title"},"Klienti"),l.a.createElement("span",{className:"close-btn",onClick:()=>t("dashboard")},"\xd7")),l.a.createElement(s,{clients:b,selectedClientId:g,onSelectClient:function(e){k(e),S(!1),j({firstName:"",lastName:""})}}),l.a.createElement(m,{editMode:w,loading:T,onEditClient:function(){const e=b.find(e=>e.id===g);e&&(S(!0),j({firstName:e.firstName,lastName:e.lastName}))},onSaveClient:K,onDeleteClient:()=>D({type:"client-delete-confirm"})}),l.a.createElement(d,{clientForm:y,loading:T,onChange:j,onSave:()=>{S(!1),K()}}),l.a.createElement(u,{type:null===O||void 0===O?void 0:O.type,loading:T,onDelete:function(){if(E.some(e=>e.clientId===g))return alert("Nelze smazat, dokud m\xe1 klient aktivn\xed rezervace."),void D(null);z(!0),fetch("/clients/".concat(g),{method:"DELETE"}).then(async e=>{if(e.ok)C(e=>e.filter(e=>e.id!==g)),k(e=>{const t=b.filter(t=>t.id!==e);return t.length>0?t[0].id:null}),D(null);else{const t=await e.json();t&&t.error&&t.error.includes("Nelze smazat klienta")&&D({type:"client-delete-error"})}}).finally(()=>z(!1))},onClose:()=>D(null)})):l.a.createElement("div",{className:"mobile-container"},l.a.createElement("div",{className:"header"},l.a.createElement("span",{className:"app-title clickable",onClick:()=>t("dashboard")},"BookeeApp")),l.a.createElement("div",{className:"header-sub"},l.a.createElement("span",{className:"page-title"},"Rezervace"),l.a.createElement("span",{className:"clients-btn clickable right",onClick:()=>t("clients")},"Klienti")),l.a.createElement("div",{className:"week-picker"},l.a.createElement("button",{onClick:()=>{console.log("WEEK PICKER BUTTON CLICK"),h(!0)}},function(e){if(!e||isNaN(new Date(e).getTime()))return"";const t=new Date(e);if(isNaN(t.getTime()))return"";const a=new Date(t);return a.setDate(t.getDate()+4),"".concat(t.getDate(),". ").concat(t.getMonth()+1,". \u2013 ").concat(a.getDate(),". ").concat(a.getMonth()+1,". ").concat(a.getFullYear())}(a)||"v\xfdb\u011br t\xfddne"),c&&l.a.createElement("div",{className:"modal"},l.a.createElement("div",{className:"modal-content"},l.a.createElement("input",{type:"date",value:v(a),onChange:e=>{console.log("DATE PICKER INPUT CHANGE",e.target.value),r(f(new Date(e.target.value))),h(!1)}}),l.a.createElement("button",{onClick:()=>{console.log("WEEK PICKER MODAL CLOSE"),h(!1)}},"Zp\u011bt")))),l.a.createElement("div",{className:"calendar"},l.a.createElement("div",{className:"calendar-row"},l.a.createElement("div",{className:"calendar-day-label hour-label"},"hod."),Array.from({length:14},(e,t)=>l.a.createElement("div",{key:t,className:"calendar-hour-btn hour-label-cell",style:{pointerEvents:"none",background:"#f7f7f7",color:"#1976d2",fontWeight:500}},6+t,"."))),N.map((e,t)=>l.a.createElement("div",{className:"calendar-row",key:t},l.a.createElement("div",{className:"calendar-day-label"},e),Array.from({length:14},(e,a)=>{const n=6+a,r=I(t,n);let c=null;return r&&(c=b.find(e=>e.id===r.clientId)),l.a.createElement("button",{key:n,className:"calendar-hour-btn"+(r?" reserved blue":" free"),onClick:()=>function(e,t){j({firstName:"",lastName:""});const a=I(e,t);D(a?{type:"reservation-view",data:{reservation:a}}:{type:"reservation-create",data:{dayIdx:e,hour:t}})}(t,n),title:r&&c?"".concat(c.firstName," ").concat(c.lastName):void 0},r?"\u2022":"")})))),"reservation-create"===(null===O||void 0===O?void 0:O.type)&&l.a.createElement("div",{className:"modal"},l.a.createElement("div",{className:"modal-content"},l.a.createElement("p",{className:"modal-title"},"Zvolte klienta"),l.a.createElement("div",{className:"client-list modal-list"},b.map((e,t)=>l.a.createElement("div",{key:e.id,className:"client-row"+(y.firstName===e.firstName&&y.lastName===e.lastName?" selected":""),onClick:()=>j({firstName:e.firstName,lastName:e.lastName})},e.firstName," ",e.lastName))),l.a.createElement("div",{className:"modal-subtitle"},"Zad\xe1n\xed nov\xe9ho klienta"),l.a.createElement("input",{placeholder:"Jm\xe9no",value:y.firstName,onChange:e=>j(Object(o.a)(Object(o.a)({},y),{},{firstName:e.target.value}))}),l.a.createElement("input",{placeholder:"P\u0159\xedjmen\xed",value:y.lastName,onChange:e=>j(Object(o.a)(Object(o.a)({},y),{},{lastName:e.target.value}))}),l.a.createElement("button",{onClick:()=>{P(y.firstName,y.lastName,O.data.dayIdx,O.data.hour)},disabled:T},"Ulo\u017eit rezervaci"),l.a.createElement("button",{onClick:()=>D(null)},"Zp\u011bt"))),"reservation-view"===(null===O||void 0===O?void 0:O.type)&&l.a.createElement("div",{className:"modal"},l.a.createElement("div",{className:"modal-content"},(()=>{const e=O.data.reservation,t=b.find(t=>t.id===e.clientId);return l.a.createElement(l.a.Fragment,null,l.a.createElement("p",{style:{fontWeight:500,marginBottom:8}},"rezervace: ",t?"".concat(t.firstName," ").concat(t.lastName):""))})(),l.a.createElement("button",{onClick:()=>{var e;e=O.data.reservation.id,z(!0),fetch("/reservations/".concat(e),{method:"DELETE"}).then(e=>e.json()).then(()=>{D(null),z(!1),fetch("/reservations?week=".concat(v(a))).then(e=>e.json()).then(e=>p(e))})},disabled:T},"Smazat"),l.a.createElement("button",{onClick:()=>D(null)},"Zp\u011bt"))))};var E=e=>{e&&e instanceof Function&&a.e(3).then(a.bind(null,17)).then(t=>{let{getCLS:a,getFID:n,getFCP:l,getLCP:r,getTTFB:c}=t;a(e),n(e),l(e),r(e),c(e)})};c.a.createRoot(document.getElementById("root")).render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(h,null))),E()},5:function(e,t,a){e.exports=a(16)}},[[5,1,2]]]);
//# sourceMappingURL=main.b6549e2b.chunk.js.map